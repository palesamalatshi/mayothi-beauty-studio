<!DOCTYPE html>
<html lang="en" x-data="siteApp()" x-init="init()" class="scroll-smooth h-full">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mayothi's Beauty Studio</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            body: ['Poppins', 'sans-serif'],
            signature: ['"Dancing Script"', 'cursive'],
          },
          colors: {
            'primary-gray': '#4b5563',
            'secondary-gray': '#6b7280',
            'text-color': '#e5e7eb',
            'bg-color': '#111827',
          },
        },
      },
    };
  </script>

  <script src="https://unpkg.com/alpinejs" defer></script>

  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Dancing+Script:wght@700&display=swap"
    rel="stylesheet" />

  <style>
    body {
      background-image: url('assets/images/background.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      font-family: 'Poppins', sans-serif;
      color: #e5e7eb;
      margin: 0;
      min-height: 100vh;
    }

    .signature-title {
      font-family: 'Dancing Script', cursive;
    }

    .gradient-text {
      background-image: linear-gradient(to right, #9ca3af, #4b5563);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .modal-overlay {
      display: none;
    }

    .modal-overlay.active {
      display: flex;
    }

    .gallery-modal-content {
      background: rgba(0, 0, 0, 0.7);
      padding: 1.5rem;
      border-radius: 1rem;
      max-width: 90vw;
      max-height: 90vh;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      width: 100%;
      border: 1px solid #374151;
    }

    .gallery-img-thumb {
      height: 128px;
      width: 100%;
      object-fit: cover !important;
      border-radius: 0.375rem;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease;
    }

    .gallery-img-thumb:hover {
      transform: scale(1.05);
    }

    .slider-img-container {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      max-height: 70vh;
    }

    .slider-img {
      max-height: 70vh;
      width: 100%;
      object-fit: contain;
      margin: 0 auto;
      border-radius: 0.75rem;
    }

    /* Add a cloak to hide the About section before Alpine.js initializes */
    [x-cloak] { display: none !important; }

    @media (max-width: 768px) {
      .service-card {
        max-width: 100%;
      }

      .gallery-modal-content {
        padding: 1rem;
        border-radius: 0.5rem;
      }

      .slider-img-container,
      .slider-img {
        max-height: 50vh;
      }

      .gallery-img-thumb {
        height: 96px;
      }
    }

    @media (max-width: 640px) {
      #bookingForm .grid-cols-2 {
        grid-template-columns: 1fr !important;
      }
    }

    footer img {
      width: 48px;
      height: 48px;
    }
  </style>
</head>

<body class="flex flex-col min-h-screen">

  <header
    class="flex flex-col md:flex-row justify-between items-center px-6 py-4 fixed w-full z-50 bg-black/60 backdrop-blur-sm shadow-md">
    <div class="flex items-center space-x-4 mb-4 md:mb-0">
      <div class="rounded-full bg-gray-500 bg-opacity-40 p-1">
        <img src="assets/images/logo.png" alt="Mayothi Logo" class="w-16 h-16 rounded-full object-cover"
          onerror="this.onerror=null;this.src='https://placehold.co/64x64/4b5563/FFFFFF?text=MBS'" />
      </div>
      <h1
        class="text-3xl font-bold signature-title bg-gradient-to-r from-gray-200 via-gray-400 to-gray-600 bg-clip-text text-transparent whitespace-nowrap">
        MAYOTHI'S BEAUTY STUDIO
      </h1>
    </div>
    <nav class="space-x-6 text-gray-300 font-semibold hidden md:flex">
      <a href="#home" class="hover:text-white transition duration-300">Home</a>
      <a href="#about" @click="showAbout = true" class="hover:text-white transition duration-300">About</a>
      <a href="#services" class="hover:text-white transition duration-300">Services</a>
      <a href="#book" class="hover:text-white transition duration-300">Book Now</a>
      <a href="#contact" class="hover:text-white transition duration-300">Contact</a>
    </nav>
    <button @click="isMobileMenuOpen = !isMobileMenuOpen" class="md:hidden text-white focus:outline-none"
      aria-label="Toggle Mobile Menu">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
      </svg>
    </button>
  </header>

  <div x-show="isMobileMenuOpen" @click.away="isMobileMenuOpen = false"
    class="md:hidden fixed top-24 left-0 right-0 z-40 bg-black/70 text-center shadow-lg pt-4"
    x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 -translate-y-4"
    x-transition:enter-end="opacity-100 translate-y-0" x-transition:leave="transition ease-in duration-300"
    x-transition:leave-start="opacity-100 translate-y-0" x-transition:leave-end="opacity-0 -translate-y-4">
    <a href="#home" @click="isMobileMenuOpen=false" class="block py-2 px-4 hover:bg-black/70 border-b border-gray-700">Home</a>
    <a href="#about" @click="isMobileMenuOpen=false; showAbout = true" class="block py-2 px-4 hover:bg-black/70 border-b border-gray-700">About</a>
    <a href="#services" @click="isMobileMenuOpen=false" class="block py-2 px-4 hover:bg-black/70 border-b border-gray-700">Services</a>
    <a href="#book" @click="isMobileMenuOpen=false" class="block py-2 px-4 hover:bg-black/70 border-b border-gray-700">Book Now</a>
    <a href="#contact" @click="isMobileMenuOpen=false" class="block py-2 px-4 hover:bg-black/70">Contact</a>
  </div>

  <main class="flex-grow pt-28">
    <section id="home" class="py-20 px-6 text-center text-white bg-black/70">
      <div class="max-w-3xl mx-auto">
        <h2 class="text-4xl md:text-5xl font-bold mb-4 tracking-wide signature-title">Where Beauty Meets Purpose</h2>
        <p class="text-lg md:text-xl leading-relaxed text-gray-300 mb-6">
          A vibrant beauty studio born in Tsakane, transforming challenges into confidence through nails, make-up,
          weave installations, and body sculpting.
        </p>
        <a href="#about" @click="showAbout = true"
          class="inline-block mt-4 bg-gray-600 hover:bg-gray-500 text-white font-medium py-2 px-6 rounded-full transition duration-300">
          Read More
        </a>
      </div>
    </section>

    <section id="about" class="px-4 py-16 bg-black/70" x-show="showAbout" x-transition x-cloak>
      <div class="max-w-4xl mx-auto flex flex-col md:flex-row items-center space-y-6 md:space-y-0 md:space-x-10">
        <img src="assets/images/Khanyi.jpg" alt="Khanyisile Mayothi Raphaka"
          class="w-full md:w-1/2 rounded shadow-lg object-cover"
          onerror="this.onerror=null;this.src='https://placehold.co/600x400/4b5563/FFFFFF?text=Khanyi'" />
        <div class="md:w-1/2">
          <h3 class="text-2xl font-bold mb-4 text-gray-400">Meet Khanyisile Mayothi Raphaka</h3>
          <p class="text-gray-300">
            In the midst of uncertainty, Khanyi turned challenge into triumph. As a self-made entrepreneur with a
            powerful vision, she founded Mayothi's Beauty Studio to empower, uplift, and beautify her community.
            Through her journey, she aims to provide beauty training, create employment, and bring hope. Her name
            isn’t just a brand—it’s a legacy rooted in resilience and passion.
          </p>
        </div>
      </div>
    </section>

    <section id="services" class="px-4 py-16 bg-black/70">
      <h2 class="text-3xl font-bold text-center mb-10 gradient-text">Our Services</h2>
      <div class="max-w-7xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
        <template x-for="service in services" :key="service.id">
          <div
            class="service-card bg-black/70 rounded-lg shadow-xl overflow-hidden cursor-pointer transform hover:scale-105 transition-transform duration-300 flex flex-col items-center p-4"
            @click="openGalleryModal(service.id)">
            <div class="w-full h-48 flex items-center justify-center mb-4">
              <img :src="service.coverImage" :alt="service.title"
                class="max-w-full max-h-full object-contain"
                :onerror="`this.onerror=null;this.src='https://placehold.co/600x400/6b7280/FFFFFF?text=${service.title}'`">
            </div>
            <div class="p-6 text-center">
              <h3 class="text-2xl font-semibold text-gray-400 mb-2" x-text="service.title"></h3>
              <p class="text-gray-400" x-text="service.description"></p>
            </div>
          </div>
        </template>
      </div>
    </section>

    <section id="book" class="px-4 py-16 bg-black/70">
      <h2 class="text-3xl font-bold text-center mb-10 gradient-text">Book Your Appointment</h2>
      <div class="max-w-xl mx-auto bg-black/70 rounded-lg shadow-xl overflow-hidden p-6">
        <form id="bookingForm" class="space-y-4" @submit.prevent="submitBooking">
          <div>
            <label for="name" class="block text-gray-300 font-medium mb-1">Your Name</label>
            <input type="text" id="name" name="name" x-model="bookingForm.name"
              class="w-full p-2 bg-gray-800 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500"
              required />
          </div>
          <div>
            <label for="email" class="block text-gray-300 font-medium mb-1">Email Address</label>
            <input type="email" id="email" name="email" x-model="bookingForm.email"
              class="w-full p-2 bg-gray-800 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500"
              placeholder="you@example.com" required />
          </div>
          <div>
            <label for="phone" class="block text-gray-300 font-medium mb-1">WhatsApp Number</label>
            <input type="tel" id="phone" name="phone" x-model="bookingForm.phone"
              class="w-full p-2 bg-gray-800 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500"
              placeholder="0610665969" required />
          </div>
          <div>
            <label for="service" class="block text-gray-300 font-medium mb-1">Service</label>
            <select id="service" name="service" x-model="bookingForm.serviceId" @change="handleServiceChange"
              class="w-full p-2 bg-gray-800 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500"
              required>
              <option value="">Select a service...</option>
              <template x-for="service in services" :key="service.id">
                <option :value="service.id" x-text="service.title"></option>
              </template>
            </select>
          </div>
          <div x-show="showPriceOptions" x-transition>
            <label for="price" class="block text-gray-300 font-medium mb-1">Choose Option</label>
            <select id="price" name="price" x-model="bookingForm.priceId" @change="updateBookingPrice(); filterAvailableTimes()"
              class="w-full p-2 bg-gray-800 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500"
              required>
              <option value="">Select an option...</option>
              <template x-for="price in selectedService.prices" :key="price.id">
                <option :value="price.id" x-text="price.name + ' - R' + price.amount"></option>
              </template>
            </select>
          </div>
          <div class="flex items-center space-x-2">
            <input type="checkbox" id="houseCall" name="houseCall" x-model="bookingForm.houseCall"
              @change="toggleAddressContainer(); updateBookingPrice()"
              class="form-checkbox h-5 w-5 text-gray-600 bg-gray-700 border-gray-600 rounded" />
            <label for="houseCall" class="text-gray-300 font-medium">House Call</label>
          </div>
          <div x-show="showAddressInput" x-transition>
            <label for="address" class="block text-gray-300 font-medium mb-1">Your Address</label>
            <input type="text" id="address" name="address" x-model="bookingForm.address"
              class="w-full p-2 bg-gray-800 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500" />
            <label for="distance" class="block text-gray-300 font-medium mb-1 mt-2">Distance from Mayothis Beauty Studio to your address (km)</label>
            <input type="number" id="distance" name="distance" x-model.number="bookingForm.distance"
              @input="updateBookingPrice()" min="1" step="0.1"
              class="w-full p-2 bg-gray-800 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500"
              placeholder="Enter distance in kilometers" />
            <p class="text-xs text-gray-400 mt-1">*Use Google Maps or any map app to estimate the distance.</p>
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label for="date" class="block text-gray-300 font-medium mb-1">Date</label>
              <input type="date" id="date" name="date" x-model="bookingForm.date" @change="filterAvailableTimes()"
                class="w-full p-2 bg-gray-800 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500"
                :min="minDate" required />
            </div>
            <div>
              <label for="time" class="block text-gray-300 font-medium mb-1">Time</label>
              <select id="time" name="time" x-model="bookingForm.time"
                class="w-full p-2 bg-gray-800 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-gray-500"
                required>
                <option value="">Select time</option>
                 <template x-if="availableTimes.length === 0 && bookingForm.date && bookingForm.priceId">
                    <option disabled>No slots available</option>
                </template>
                <template x-for="time in availableTimes" :key="time">
                  <option :value="time" x-text="time"></option>
                </template>
              </select>
            </div>
          </div>
          <div class="text-lg font-bold text-gray-200 mt-4 text-center">
            Total Price: R<span x-text="totalPrice.toFixed(2)"></span>
          </div>
          <button type="submit"
            class="w-full py-3 bg-gray-600 hover:bg-gray-500 text-white font-semibold rounded-md shadow-lg transition duration-300">
            Book Now
          </button>
        </form>
      </div>
    </section>

    <section id="contact" class="py-24 px-6 bg-black/70">
      <div class="max-w-7xl mx-auto bg-black/70 rounded-2xl p-8 md:p-12">
        <h2 class="text-4xl font-bold text-center gradient-text mb-4">Contact Us</h2>
        <p class="text-center text-lg text-gray-400 max-w-2xl mx-auto mb-8">
          Ready to book? Have a question? Reach out to us through our social channels or by email.
        </p>
        <div class="flex flex-wrap justify-center gap-8 text-3xl">
          <a href="https://wa.me/27610665969" target="_blank" class="text-gray-300 hover:text-green-500 transition duration-300"
            aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
          <a href="tel:+27676948811" class="text-gray-300 hover:text-gray-500 transition duration-300"
            aria-label="Phone"><i class="fas fa-phone"></i></a>
          <a href="mailto:khanyisileraphaka@gmail.com" class="text-gray-300 hover:text-gray-500 transition duration-300"
            aria-label="Email"><i class="fas fa-envelope"></i></a>
        </div>
      </div>
    </section>

    <div x-show="bookingModalOpen" x-transition.opacity class="fixed inset-0 flex items-center justify-center z-50 bg-black/80">
      <div class="bg-gray-900 rounded-lg shadow-lg max-w-md p-8 mx-4 text-white space-y-6 relative">
        <button @click="bookingModalOpen = false"
          class="absolute top-2 right-2 text-gray-300 hover:text-white text-3xl font-bold leading-none">&times;</button>
        <h3 class="text-2xl font-bold mb-4">Please Complete Your Payment</h3>
        <p>Your payment is required to confirm your booking.</p>
        <div class="text-left space-y-2">
          <p><strong>Name:</strong> <span x-text="bookingForm.name"></span></p>
          <p><strong>Email:</strong> <span x-text="bookingForm.email"></span></p>
          <p><strong>Phone:</strong> <span x-text="bookingForm.phone"></span></p>
          <p><strong>Service:</strong> <span x-text="selectedService.title"></span></p>
          <p><strong>Option:</strong> <span x-text="selectedService.prices.find(p => p.id === bookingForm.priceId)?.name"></span>
          </p>
          <p><strong>Date:</strong> <span x-text="bookingForm.date"></span></p>
          <p><strong>Time:</strong> <span x-text="bookingForm.time"></span></p>
          <p><strong>House Call:</strong> <span x-text="bookingForm.houseCall ? 'Yes' : 'No'"></span></p>
          <template x-if="bookingForm.houseCall">
            <p><strong>Address:</strong> <span x-text="bookingForm.address"></span></p>
          </template>
          <p><strong>Total Amount:</strong> R<span x-text="totalPrice.toFixed(2)"></span></p>
        </div>
        
        <div id="payment-container">
          <form action="https://www.payfast.co.za/eng/process" method="post" target="_blank" novalidate>
            <input type="hidden" name="merchant_id" value="20959323" />
            <input type="hidden" name="merchant_key" value="yxctyunmw2qow" />
            <input type="hidden" name="amount" x-bind:value="totalPrice.toFixed(2)" />
            <input type="hidden" name="item_name" x-bind:value="selectedService.title + ' Booking'" />
            <input type="hidden" name="email_address" x-bind:value="bookingForm.email" />
            <input type="hidden" name="name_first" x-bind:value="bookingForm.name" />
            <input type="hidden" name="cell_number" x-bind:value="bookingForm.phone" />
            <input type="hidden" name="return_url" value="https://mayothisbeautystudio.co.za/thank-you.html" />
            <input type="hidden" name="cancel_url" value="https://mayothisbeautystudio.co.za/cancel.html" />
            <button type="submit" @click="handlePayment"
              class="w-full py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-md shadow-lg transition duration-300 mt-2">
              Proceed to Pay with PayFast
            </button>
          </form>
        </div>
      </div>
    </div>

    <div x-show="isGalleryModalOpen" @keydown.escape.window="closeGalleryModal"
      class="modal-overlay fixed inset-0 bg-black/80 flex justify-center items-center z-50"
      x-transition.opacity x-cloak>
      <div @click.away="closeGalleryModal" x-show="isGalleryModalOpen" x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0 scale-90" x-transition:enter-end="opacity-100 scale-100"
        x-transition:leave="transition ease-in duration-300" x-transition:leave-start="opacity-100 scale-100"
        x-transition:leave-end="opacity-0 scale-90" class="gallery-modal-content">
        <div class="flex justify-between items-center pb-4 border-b border-gray-700">
          <h3 class="text-2xl font-bold text-gray-300">Gallery for <span x-text="selectedService.title"></span></h3>
          <button @click="closeGalleryModal" class="text-gray-400 hover:text-white transition duration-300 focus:outline-none"
            aria-label="Close gallery">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round"
                stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
          </button>
        </div>
        <div x-show="selectedService.images && selectedService.images.length > 0" class="mt-4 flex-grow relative">
          <div class="slider-img-container relative">
            <img :src="selectedService.images[currentImageIndex]" alt="Gallery Image"
              class="slider-img rounded-lg shadow-lg max-w-full mx-auto"
              :onerror="`this.onerror=null;this.src='https://placehold.co/800x600/111827/e5e7eb?text=Image+Not+Found'`" />
            <button @click="changeImage(-1)"
              class="absolute left-0 top-1/2 -translate-y-1/2 p-2 rounded-full bg-black/50 text-white hover:bg-black/70 transition duration-300 focus:outline-none"
              aria-label="Previous image">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
            </button>
            <button @click="changeImage(1)"
              class="absolute right-0 top-1/2 -translate-y-1/2 p-2 rounded-full bg-black/50 text-white hover:bg-black/70 transition duration-300 focus:outline-none"
              aria-label="Next image">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
            </button>
          </div>
          <div class="mt-6">
            <h4 class="text-xl font-semibold text-gray-300 mb-2 text-center">Browse Gallery</h4>
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
              <template x-for="(image, index) in selectedService.images" :key="index">
                <div class="gallery-thumb-wrapper cursor-pointer" @click="currentImageIndex = index">
                  <img :src="image" alt="Thumbnail"
                    class="gallery-img-thumb rounded-md"
                    :class="{'border-2 border-gray-500 shadow-lg': index === currentImageIndex}"
                    :onerror="`this.onerror=null;this.src='https://placehold.co/150x150/111827/e5e7eb?text=Image+Not+Found'`" />
                </div>
              </template>
            </div>
          </div>
          <div class="text-center mt-6">
            <a href="#book" @click.prevent="closeGalleryModalAndScroll"
              class="inline-block px-8 py-3 bg-gray-600 text-white font-bold rounded-full hover:bg-gray-500 transition duration-300 shadow-lg transform hover:scale-105">
              Book This Service
            </a>
          </div>
        </div>
         <div x-show="!selectedService.images || selectedService.images.length === 0" class="text-center py-10 text-gray-400">
          <p>No gallery images available for this service yet.</p>
        </div>
      </div>
    </div>
  </main>
  <footer class="bg-black/70 text-white py-8 mt-auto">
    <div class="container mx-auto px-4 text-center space-y-4">
      <div class="flex justify-center">
        <img src="assets/images/logo.png" alt="Mayothi Logo" class="w-16 h-16 rounded-full border-2 border-gray-500"
          onerror="this.onerror=null;this.src='https://placehold.co/48x48/4b5563/FFFFFF?text=MBS'" />
      </div>
      <div class="flex justify-center gap-6 text-sm flex-wrap">
        <a href="https://wa.me/27610665969" target="_blank" class="hover:underline">WhatsApp</a>
        <a href="tel:+27676948811" class="hover:underline">Call</a>
        <a href="mailto:khanyisileraphaka@gmail.com" class="hover:underline">Email</a>
        <a href="https://www.instagram.com/mayo.thisbeautystudio" target="_blank" class="hover:underline">Instagram</a>
      </div>
      <div class="text-xs text-gray-300">
        Designed by Palesa Malatshi |
        <a href="mailto:palesamalatshi22@gmail.com" class="hover:underline">palesamalatshi22@gmail.com</a>
      </div>
    </div>
  </footer>

  <script>
    document.addEventListener('alpine:init', () => {
      Alpine.data('siteApp', () => ({
        // UPDATED: Added showAbout state
        isMobileMenuOpen: false,
        showAbout: false,
        bookingModalOpen: false,
        isGalleryModalOpen: false,
        currentImageIndex: 0,
        totalPrice: 0,
        showPriceOptions: false,
        showAddressInput: false,
        minDate: '',
        selectedService: { id: '', title: '', images: [], prices: [] },
        bookingForm: {
          name: '',
          email: '',
          phone: '',
          serviceId: '',
          priceId: '',
          houseCall: false,
          address: '',
          distance: null,
          date: '',
          time: ''
        },
        bookings: [],
        bookingTimes: [],
        availableTimes: [],
        services: [
          {
            id: 'nails',
            title: 'Nails',
            description: 'Acrylic | Gel | Pedicures',
            coverImage: 'assets/images/nails.jpg',
            images: [
              'assets/images/nails1.jpg','assets/images/nails2.jpg','assets/images/nails3.jpg','assets/images/nails4.jpg','assets/images/nails5.jpg',
            ],
            prices: [
              { id: 'short-p', name: 'Short Plain', amount: 180, duration: 30 },
              { id: 'short-d', name: 'Short with Design', amount: 220, duration: 45 },
              { id: 'medium-p', name: 'Medium Plain', amount: 220, duration: 45 },
              { id: 'medium-d', name: 'Medium with Design', amount: 260, duration: 60 },
              { id: 'large-p', name: 'Large Plain', amount: 260, duration: 60 },
              { id: 'large-d', name: 'Large with Design', amount: 300, duration: 75 },
              { id: 'x-large-p', name: 'X-Large Plain', amount: 300, duration: 75 },
              { id: 'x-large-d', name: 'X-Large with Design', amount: 350, duration: 90 },
              { id: 'gel-pol', name: 'Gel Polish', amount: 140, duration: 30 },
              { id: 'gel-lay', name: 'Gel Overlay', amount: 100, duration: 30 },
              { id: 'buff-and-shine-p', name: 'Buff and Shine Plain', amount: 100, duration: 20 },
              { id: 'buff-and-shine-d', name: 'Buff and Shine Design', amount: 160, duration: 30 },
              { id: 'ped-gel', name: 'Pedicure Gel', amount: 120, duration: 45 },
              { id: 'ped-acrylic', name: 'Pedicure Acrylic', amount: 160, duration: 50 },
            ],
          },
          {
            id: 'makeup',
            title: 'Make-up',
            description: 'Natural | Soft-Glam | Bridal',
            coverImage: 'assets/images/makeup.jpg',
            images: [ 'assets/images/makeup1.jpg', 'assets/images/makeup2.jpg', 'assets/images/makeup3.jpg' ],
            prices: [
              { id: 'natural-makeup', name: 'Natural Look', amount: 200, duration: 60 },
              { id: 'soft-glam', name: 'Soft Glam', amount: 250, duration: 75 },
              { id: 'bridal-makeup', name: 'Bridal', amount: 400, duration: 120 },
            ],
          },
          {
            id: 'hair',
            title: 'Hair',
            description: 'Weave Installations',
            coverImage: 'assets/images/weave.jpg',
            images: [ 'assets/images/installation.jpg', 'assets/images/styled.jpg' ],
            prices: [
              { id: 'weave-install', name: 'Weave Installation', amount: 250, duration: 90 },
              { id: 'styled-weave-install', name: 'Styled Weave Installation', amount: 300, duration: 120 },
            ],
          },
          {
            id: 'cavitation',
            title: 'Cavitation Reduction',
            description: 'Fat Reduction Therapy',
            coverImage: 'assets/images/cavitation.jpg',
            images: [ 'assets/images/cavitation1.jpg', 'assets/images/cavitation2.jpg' ],
            prices: [
              { id: 'one-sess-per', name: '1 Session', amount: 600, duration: 60 },
              { id: 'three-sess-per', name: '3 Sessions', amount: 1500, duration: 60 },
              { id: 'one-sess-per-pad', name: '1 Session with Lipopads', amount: 800, duration: 90 },
              { id: 'three-sess-per-pad', name: '3 Sessions with Lipopads', amount: 2000, duration: 90 },
              { id: 'one-sess-2peep', name: '1 Session (2 People)', amount: 1000, duration: 90 },
              { id: 'three-sess-2peep', name: '3 Sessions (2 People)', amount: 1500, duration: 90 },
              { id: 'one-sess-2peep-pad', name: '1 Session with Lipopads (2 People)', amount: 2000, duration: 120 },
              { id: 'three-sess-2peep-pad', name: '3 Sessions with Lipopads (2 People)', amount: 4000, duration: 120 },
            ],
          }
        ],

        // UPDATED: init() now hides the About section on load
        init() {
          this.showAbout = false;
          this.minDate = new Date().toISOString().split('T')[0];
          this.generateTimeSlots();
        },

        handleServiceChange() {
            this.selectedService = this.services.find(s => s.id === this.bookingForm.serviceId) || { id: '', title: '', images: [], prices: [] };
            this.bookingForm.priceId = '';
            this.totalPrice = 0;
            this.availableTimes = [];
            this.showPriceOptions = !!this.bookingForm.serviceId;
        },

        toggleAddressContainer() {
            this.showAddressInput = this.bookingForm.houseCall;
            if (!this.bookingForm.houseCall) {
                this.bookingForm.address = '';
                this.bookingForm.distance = null;
            }
        },

        updateBookingPrice() {
            if (!this.bookingForm.serviceId || !this.bookingForm.priceId) {
                this.totalPrice = 0;
                return;
            }
            const priceOption = this.selectedService.prices.find(p => p.id === this.bookingForm.priceId);
            let currentPrice = priceOption ? priceOption.amount : 0;
            
            if (this.bookingForm.houseCall && this.bookingForm.distance > 0) {
                const travelFee = this.bookingForm.distance * 10;
                currentPrice += travelFee;
            }
            
            this.totalPrice = currentPrice;
        },

        submitBooking() {
            this.bookingModalOpen = true;
        },
        
        handlePayment() {
          const newBooking = JSON.parse(JSON.stringify(this.bookingForm));
          this.bookings.push(newBooking);
          this.bookingModalOpen = false;
        },
        
        generateTimeSlots() {
          const startMinutes = 8 * 60;
          const endMinutes = 18 * 60;
          const interval = 15;
          let slots = [];
          for (let mins = startMinutes; mins < endMinutes; mins += interval) {
            const h = Math.floor(mins / 60);
            const m = mins % 60;
            slots.push(`${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}`);
          }
          this.bookingTimes = slots;
        },
        
        timeToMinutes(timeStr) {
          const [h, m] = timeStr.split(':').map(Number);
          return h * 60 + m;
        },
        
        filterAvailableTimes() {
          if (!this.bookingForm.serviceId || !this.bookingForm.priceId || !this.bookingForm.date) {
            this.availableTimes = [];
            return;
          }
          
          const priceOption = this.selectedService.prices.find(p => p.id === this.bookingForm.priceId);
          if (!priceOption) return;

          const duration = priceOption.duration;
          const selectedDate = this.bookingForm.date;

          const dateObj = new Date(`${selectedDate}T00:00:00`);
          const isSunday = dateObj.getDay() === 0;
          const isMajorHoliday = this.isMajorHoliday(dateObj);
          
          if (isSunday || isMajorHoliday) {
              this.availableTimes = [];
              return;
          }

          const dayEnd = this.isPublicHoliday(dateObj) ? 15 * 60 : 18 * 60;

          this.availableTimes = this.bookingTimes.filter(slot => {
            const slotStartMinutes = this.timeToMinutes(slot);
            const slotEndMinutes = slotStartMinutes + duration;
            if (slotEndMinutes > dayEnd) return false;
            if (this.checkBookingClash(selectedDate, slot, duration)) return false;
            return true;
          });
        },

        checkBookingClash(date, time, duration) {
            const requestedStart = this.timeToMinutes(time);
            const requestedEnd = requestedStart + duration;

            return this.bookings.some(booking => {
                if (booking.date !== date) return false;
                const existingService = this.services.find(s => s.id === booking.serviceId);
                const existingPrice = existingService?.prices.find(p => p.id === booking.priceId);
                if (!existingPrice) return true;
                const durationExisting = existingPrice.duration;
                const existingStart = this.timeToMinutes(booking.time);
                const existingEnd = existingStart + durationExisting;
                return requestedStart < existingEnd && existingStart < requestedEnd;
            });
        },

        isPublicHoliday(date) {
          const year = date.getFullYear();
          const publicHolidays = [`${year}-01-01`,`${year}-03-21`,`${year}-04-18`,`${year}-04-21`,`${year}-04-27`,`${year}-05-01`,`${year}-06-16`,`${year}-08-09`,`${year}-09-24`,`${year}-12-16`].map(d => new Date(d).toDateString());
          return publicHolidays.includes(date.toDateString());
        },
        
        isMajorHoliday(date) {
          const year = date.getFullYear();
          const majorHolidays = [ `${year}-12-25`, `${year}-12-26` ].map(d => new Date(d).toDateString());
          return majorHolidays.includes(date.toDateString());
        },

        openGalleryModal(serviceId) {
          this.selectedService = this.services.find(s => s.id === serviceId) || { id: '', title: '', images: [], prices: [] };
          this.currentImageIndex = 0;
          this.isGalleryModalOpen = true;
          document.body.style.overflow = 'hidden';
        },
        
        closeGalleryModal() {
          this.isGalleryModalOpen = false;
          document.body.style.overflow = 'auto';
        },
        
        changeImage(direction) {
          const images = this.selectedService.images;
          if (!images || images.length === 0) return;
          let newIndex = this.currentImageIndex + direction;
          if (newIndex < 0) {
            newIndex = images.length - 1;
          } else if (newIndex >= images.length) {
            newIndex = 0;
          }
          this.currentImageIndex = newIndex;
        },

        closeGalleryModalAndScroll() {
          this.closeGalleryModal();
          this.bookingForm.serviceId = this.selectedService.id;
          this.handleServiceChange();
          document.querySelector('#book').scrollIntoView({ behavior: 'smooth' });
        }
      }));
    });
  </script>

</body>


</html>
